<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ログイン</title>
<style>
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background-color: #fff;
    padding: 1rem;
    max-width: 480px;
    margin: 2rem auto;
    color: #333;
  }
  h1 {
    text-align: center;
    margin-bottom: 2rem;
  }
  form {
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 2rem;
    background-color: #f9f9f9;
  }
  label {
    display: block;
    margin-bottom: 0.4rem;
    font-weight: bold;
  }
  input[type="email"],
  input[type="password"] {
    width: 100%;
    padding: 0.6rem;
    margin-bottom: 1.2rem;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
    font-size: 1rem;
  }
  button {
    width: 100%;
    background-color: #007bff;
    color: white;
    border: none;
    padding: 0.75rem;
    font-size: 1rem;
    border-radius: 4px;
    cursor: pointer;
  }
  button:hover {
    background-color: #0056b3;
  }
  #error-message {
    margin-top: 1rem;
    color: #d93025;
    font-weight: bold;
  }
  #google-login {
    margin-top: 1rem;
    background-color: #db4437;
  }
  #google-login:hover {
    background-color: #a3332a;
  }
</style>
</head>
<body>
  <h1>ログイン</h1>
  <form id="login-form" autocomplete="on">
    <label for="email">メールアドレス</label>
    <input type="email" id="email" name="email" autocomplete="email" required />
    <label for="password">パスワード</label>
    <input type="password" id="password" name="password" autocomplete="current-password" required />
    <button type="submit">ログイン</button>
    <div id="error-message"></div>
  </form>
  <button id="google-login" type="button">Googleでログイン</button>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
  import {
    getAuth,
    signInWithEmailAndPassword,
    signInWithPopup,
    GoogleAuthProvider,
  } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCTiKqnIOMyveGLedrWsABuZQBgcQk3hVM",
    authDomain: "tiiki-memo.firebaseapp.com",
    projectId: "tiiki-memo",
    storageBucket: "tiiki-memo.appspot.com",
    messagingSenderId: "119948839279",
    appId: "1:119948839279:web:e87447e9020b1bfae5c09a",
    measurementId: "G-TNEKKJ20SV",
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  document.getElementById("login-form").addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;
    const errorMsg = document.getElementById("error-message");
    errorMsg.textContent = "";

    try {
      await signInWithEmailAndPassword(auth, email, password);
      window.location.href = "index.html";
    } catch (error) {
      errorMsg.textContent = "ログインに失敗しました: " + error.message;
    }
  });

  document.getElementById("google-login").addEventListener("click", async () => {
    const provider = new GoogleAuthProvider();
    const errorMsg = document.getElementById("error-message");
    errorMsg.textContent = "";

    try {
      await signInWithPopup(auth, provider);
      window.location.href = "index.html";
    } catch (error) {
      errorMsg.textContent = "Googleログインに失敗しました: " + error.message;
    }
  });
</script>
</body>
</html>
